USE master;

IF EXISTS(SELECT * FROM sys.databases WHERE name = 'db01')
BEGIN
	ALTER DATABASE db01 SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
	DROP DATABASE db01;
END
GO
CREATE DATABASE db01;
GO
USE db01;

CREATE TABLE dbo.Test(id int IDENTITY(1, 1) PRIMARY KEY, data nchar(4000));

GO

BACKUP DATABASE db01 TO DISK='db01.bak' WITH INIT;

INSERT INTO dbo.Test(data) VALUES('A') 
GO 10000

--BACKUP DATABASE db01 TO DISK='db01.bak' WITH INIT;

GO

dbcc checkdb with no_infomsgs 

dbcc ind('db01', 'dbo.Test', -1)

ALTER DATABASE db01 SET SINGLE_USER;

dbcc writepage('db01', 1, 280, 4000, 1, 0x45, 1);

GO
dbcc checkdb with no_infomsgs

ALTER DATABASE db01 SET MULTI_USER;

SELECT * FROM dbo.Test
SELECT COUNT(*) FROM dbo.Test

CREATE TABLE dbo.TT2(id int)

SELECT * FROM dbo.TT2

INSERT INTO dbo.TT2(id) VALUES(1), (2), (3), (4), (5), (6), (7), (8), (9), (10);

SELECT * FROM dbo.TT2


USE [master]
RESTORE DATABASE [db01] PAGE='1:280' FROM  DISK = N'D:\Backups\db01.bak' WITH  FILE = 1,  NORECOVERY,  NOUNLOAD,  STATS = 5
BACKUP LOG [db01] TO  DISK = N'D:\Backups\db01_LogBackup_2025-06-11_19-43-09.bak' WITH NOFORMAT, NOINIT,  NAME = N'db01_LogBackup_2025-06-11_19-43-09', NOSKIP, NOREWIND, NOUNLOAD,  STATS = 5
RESTORE LOG [db01] FROM  DISK = N'D:\Backups\db01_LogBackup_2025-06-11_19-43-09.bak' WITH  NOUNLOAD,  STATS = 5

GO




/*
USE [master]
RESTORE DATABASE [db01] PAGE='1:360' FROM  DISK = N'C:\Backups\db01.bak' WITH  FILE = 1,  NORECOVERY,  NOUNLOAD,  STATS = 5
BACKUP LOG [db01] TO  DISK = N'C:\Backups\db01_LogBackup_2025-03-23_09-15-41.bak' WITH NOFORMAT, NOINIT,  NAME = N'db01_LogBackup_2025-03-23_09-15-41', NOSKIP, NOREWIND, NOUNLOAD,  STATS = 5
RESTORE LOG [db01] FROM  DISK = N'C:\Backups\db01_LogBackup_2025-03-23_09-15-41.bak' WITH  NOUNLOAD,  STATS = 5

GO
*/

USE db01

dbcc checkdb with no_infomsgs

SELECT * FROM dbo.Test
SELECT COUNT(*) FROM dbo.Test

